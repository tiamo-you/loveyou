<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- æ‰‹æ©Ÿé©é… -->
  <title>æµªæ¼«ç§‘å­¸å‘Šç™½</title>
  <style>
    body {
      background: #fcefee;
      font-family: 'Noto Serif TC','KaiTi','DFKai-SB','Microsoft JhengHei',serif;
      margin: 0;
      padding: 0;
      overflow-y: scroll;
    }

    .envelope-container {
      position: relative;
      width: 90%;
      max-width: 420px;
      margin: 100px auto 0;
      min-height: 600px;
    }

    .envelope {
      position: relative;
      width: 100%;
      height: 220px;
      background: #fff0f5;
      border: 2px solid #e6b7c8;
      border-radius: 6px;
      box-shadow: 0 6px 15px rgba(0,0,0,0.2);
      overflow: hidden;
      z-index: 2;
    }

    /* flap */
    .flap {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 120px;
      background: #ffc0cb;
      clip-path: polygon(0 0, 100% 0, 50% 100%);
      transform-origin: top;
      transition: transform 1s ease-in-out;
      z-index: 3;
    }
    .envelope.open .flap {
      transform: rotateX(-180deg);
    }

    /* æ‰“é–‹æŒ‰éˆ• */
    .open-btn {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      padding: 10px 20px;
      font-size: 18px;
      color: #ff4fa1;
      background: #fff;
      border: 2px solid #ff4fa1;
      border-radius: 10px;
      cursor: pointer;
      z-index: 10;
      animation: glow 1.5s infinite alternate;
    }
    @keyframes glow {
      from { box-shadow: 0 0 5px #ff4fa1; }
      to { box-shadow: 0 0 15px #ff99cc; }
    }

    /* ä¿¡ç´™ */
    .letter {
      position: absolute;
      left: 50%;
      transform: translateX(-50%);
      bottom: 10px;
      width: 95%;
      background: #fdfaf4;
      background-image: url("https://www.transparenttextures.com/patterns/paper-fibers.png");
      border: 1px solid #e0d6c5;
      padding: 18px;
      box-sizing: border-box;
      border-radius: 6px;
      max-height: 60vh; /* é«˜åº¦éš¨è¢å¹•èª¿æ•´ */
      overflow-y: auto;
      opacity: 0;
      transition: bottom 1.2s ease-in-out 0.6s, opacity 1.2s ease-in-out 0.6s;
      z-index: 1;
      box-shadow: 0 4px 12px rgba(0,0,0,0.25);
      font-size: 16px;
      line-height: 1.8em;
      color: #4b2e2e;
      font-family: 'Noto Serif TC','KaiTi','DFKai-SB','Microsoft JhengHei',serif;
      white-space: pre-line;
    }
    .letter.show {
      bottom: 250px;
      opacity: 1;
      z-index: 5;
    }

    /* åŒæ„/ä¸åŒæ„æŒ‰éˆ• - å·¦å³ */
    .response-btns {
      display: flex;
      justify-content: space-between;
      margin-top: 15px;
    }
    .response-btns button {
      flex: 1;
      font-size: 16px;
      padding: 10px 12px;
      margin: 0 6px;
      border-radius: 8px;
      border: none;
      cursor: pointer;
      transition: transform 0.2s;
    }
    .agree-btn {
      background: #ff99cc;
      color: #fff;
    }
    .agree-btn:hover {
      background: #ff66aa;
      transform: scale(1.05);
    }
    .disagree-btn {
      background: #bbb;
      color: #fff;
    }
    .disagree-btn:hover {
      background: #999;
      transform: scale(1.05);
    }

    /* æµ®å‹•é€šçŸ¥ */
    .toast {
      position: fixed;
      bottom: 15px;
      right: 15px;
      background: #ff66aa;
      color: white;
      padding: 10px 16px;
      border-radius: 8px;
      font-size: 14px;
      box-shadow: 0 3px 8px rgba(0,0,0,0.3);
      opacity: 0;
      transform: translateY(25px);
      transition: opacity 0.5s, transform 0.5s;
      z-index: 9999;
    }
    .toast.show {
      opacity: 1;
      transform: translateY(0);
    }

    /* å°è¢å¹•èª¿æ•´ */
    @media (max-width: 400px) {
      .open-btn {
        font-size: 16px;
        padding: 8px 16px;
      }
      .letter {
        font-size: 15px;
        padding: 15px;
      }
    }
  </style>
</head>
<body>
  <div class="envelope-container">
    <div class="envelope" id="envelope">
      <div class="flap"></div>
      <button class="open-btn" id="openBtn">ğŸ’Œ é»æˆ‘æ‰“é–‹ ğŸ’Œ</button>
    </div>

    <div class="letter" id="letter">
      <p>
åœ¨å®‡å®™çš„ç„¡æ•¸æ†æ˜Ÿè£¡  
æˆ‘å»åªè¢«ä½ å¸å¼•  
åƒè³ªé»åœ¨å¼•åŠ›å ´è£¡æ°¸é ä¸æœƒé€ƒé›¢  

æ„›å› æ–¯å¦çš„ç›¸å°å°è«–
è®“æˆ‘å€‘çš„æ™‚é–“äº¤éŒ¯
åœ¨æ™‚ç©ºçš„æ›²ç‡ä¸­
ä½ å°æˆ‘
å°±åƒæ˜¯å…‰é€Ÿä¸è®Šçš„çœŸç†
åœ¨å®‡å®™çš„è†¨è„¹ä¸­
åƒæ˜¯å®‡å®™å¸¸æ•¸
åœ¨ç„¡é™çš„ç©ºé–“è£¡
ä½ å°æˆ‘
åƒæ˜¯é»‘æ´çš„å¼•åŠ›
åœ¨ç„¡æ³•é€ƒè„«çš„æ·±æ·µ    

ç‰›é “çš„è¬æœ‰å¼•åŠ›
è®“æˆ‘å‘ä½ é£›å»
æ„›æƒ…çš„åŒ–å­¸åæ‡‰
è®“æˆ‘èˆ‡ä½ çš„éˆé­‚äº¤è
ä½ å°æˆ‘
åƒæ˜¯åŒ–å­¸éµ
åœ¨åˆ†å­ä¸­ç‰¢ç‰¢ç›¸é€£
ä½ å°æˆ‘
å°±åƒæ˜¯é‡å­ç³¾çº
åœ¨ç„¡é™çš„æ™‚ç©ºè£¡
ä½ å°æˆ‘
å°±åƒæ˜¯å…©å€‹é‡å­ç²’å­
åœ¨åŒä¸€å€‹æ³¢å‡½æ•¸ä¸­
ç„¡è«–è·é›¢å¤šé 
æˆ‘å°ä½ 
å°±åƒæ˜¯å…©å€‹é‡å­ç²’å­
åœ¨åŒä¸€å€‹é‡å­æ…‹ä¸­
ç„¡è«–æ™‚é–“å¤šé•·

æˆ‘ä¸æ‡‚æ‰€æœ‰æ„›çš„å…¬å¼  
ä½†æˆ‘çŸ¥é“  
ç­”æ¡ˆæ°¸é æŒ‡å‘ä½   
ä½ å¯ä»¥æˆç‚ºé€™å€‹å…¬å¼ä¸­å”¯ä¸€çš„è§£ç­”å—
      </p>

      <div class="response-btns">
        <button class="disagree-btn" onclick="sendResponse('disagree')">ä¸åŒæ„ âŒ</button>
        <button class="agree-btn" onclick="sendResponse('agree')">åŒæ„ âœ…</button>
      </div>
    </div>
  </div>

  <!-- æµ®å‹•é€šçŸ¥ -->
  <div class="toast" id="toast"></div>

  <script>
    document.getElementById("openBtn").addEventListener("click", function() {
      document.getElementById("envelope").classList.add("open");
      document.getElementById("letter").classList.add("show");
      this.style.display = "none"; 
    });

    function sendResponse(answer) {
      const data = {
        response: answer,
        timestamp: Date.now()
      };

      fetch("https://tiamo-8ff28-default-rtdb.asia-southeast1.firebasedatabase.app/responses.json", {
        method: "POST",
        body: JSON.stringify(data)
      }).then(res => {
        if(res.ok){
          showToast(answer === "agree" ? "ğŸ’– å·²é€å‡ºï¼šåŒæ„ï¼" : "ğŸ˜¢ å·²é€å‡ºï¼šä¸åŒæ„...");
          showBrowserNotification(answer);
        } else {
          showToast("âš ï¸ å‚³é€å¤±æ•—ï¼Œè«‹å†è©¦ä¸€æ¬¡");
        }
      });
    }

    function showToast(msg) {
      const toast = document.getElementById("toast");
      toast.textContent = msg;
      toast.classList.add("show");
      setTimeout(() => {
        toast.classList.remove("show");
      }, 3000);
    }

    function showBrowserNotification(answer){
      if(Notification.permission === "granted"){
        new Notification("ğŸ’Œ å‘Šç™½å›è¦†", {
          body: answer === "agree" ? "ä»–/å¥¹åŒæ„å•¦ï¼ğŸ’–" : "ä»–/å¥¹æ‹’çµ•äº†â€¦ğŸ’”",
          icon: "https://cdn-icons-png.flaticon.com/512/833/833472.png"
        });
      } else if(Notification.permission !== "denied"){
        Notification.requestPermission().then(permission => {
          if(permission === "granted"){
            showBrowserNotification(answer);
          }
        });
      }
    }
  </script>
</body>
</html>